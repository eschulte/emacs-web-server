<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<title>Tutorials</title>
<!-- 2014-03-10 Mon 10:46 -->
<meta  http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta  name="generator" content="Org-mode" />
<style type="text/css">
 <!--/*--><![CDATA[/*><!--*/
  .title  { text-align: center; }
  .todo   { font-family: monospace; color: red; }
  .done   { color: green; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #ccc;
    box-shadow: 3px 3px 3px #eee;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: visible;
    padding-top: 1.2em;
  }
  pre.src:before {
    display: none;
    position: absolute;
    background-color: white;
    top: -10px;
    right: 10px;
    padding: 3px;
    border: 1px solid black;
  }
  pre.src:hover:before { display: inline;}
  pre.src-sh:before    { content: 'sh'; }
  pre.src-bash:before  { content: 'sh'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-R:before     { content: 'R'; }
  pre.src-perl:before  { content: 'Perl'; }
  pre.src-java:before  { content: 'Java'; }
  pre.src-sql:before   { content: 'SQL'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.right  { text-align: center;  }
  th.left   { text-align: center;   }
  th.center { text-align: center; }
  td.right  { text-align: right;  }
  td.left   { text-align: left;   }
  td.center { text-align: center; }
  dt { font-weight: bold; }
  .footpara:nth-child(2) { display: inline; }
  .footpara { display: block; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  /*]]>*/-->
</style>
<style>pre{background:#232323; color:#E6E1DC;} table{margin:auto; width:50%;} @media(min-width:800px){div#content{max-width:800px; padding:2em; margin:auto;}}</style>
<script type="text/javascript">
/*
@licstart  The following is the entire license notice for the
JavaScript code in this tag.

Copyright (C) 2012-2013 Free Software Foundation, Inc.

The JavaScript code in this tag is free software: you can
redistribute it and/or modify it under the terms of the GNU
General Public License (GNU GPL) as published by the Free Software
Foundation, either version 3 of the License, or (at your option)
any later version.  The code is distributed WITHOUT ANY WARRANTY;
without even the implied warranty of MERCHANTABILITY or FITNESS
FOR A PARTICULAR PURPOSE.  See the GNU GPL for more details.

As additional permission under GNU GPL version 3 section 7, you
may distribute non-source (e.g., minimized or compacted) forms of
that code without the copy of the GNU GPL normally required by
section 4, provided you include this license notice and a URL
through which recipients can access the Corresponding Source.


@licend  The above is the entire license notice
for the JavaScript code in this tag.
*/
<!--/*--><![CDATA[/*><!--*/
 function CodeHighlightOn(elem, id)
 {
   var target = document.getElementById(id);
   if(null != target) {
     elem.cacheClassElem = elem.className;
     elem.cacheClassTarget = target.className;
     target.className = "code-highlighted";
     elem.className   = "code-highlighted";
   }
 }
 function CodeHighlightOff(elem, id)
 {
   var target = document.getElementById(id);
   if(elem.cacheClassElem)
     elem.className = elem.cacheClassElem;
   if(elem.cacheClassTarget)
     target.className = elem.cacheClassTarget;
 }
/*]]>*///-->
</script>
</head>
<body>
<div id="content">
<h1 class="title">Tutorials</h1>
<div id="table-of-contents">
<h2>Table of Contents</h2>
<div id="text-table-of-contents">
<ul>
<li><a href="#sec-1">1. Installation and running a server</a></li>
<li><a href="#sec-2">2. Running behind a proxy</a></li>
<li><a href="#sec-3">3. Running behind an https proxy</a>
<ul>
<li><a href="#sec-3-1">3.1. Apache</a></li>
<li><a href="#sec-3-2">3.2. Nginx</a></li>
</ul>
</li>
</ul>
</div>
</div>
<p>
The following tutorials walk through common usage scenarios including
installing the Emacs web-server and running it behind a proxy.
Install the Emacs web-server and run <code>(info "web-server")</code> to browse
the full manual within Emacs, or view the HTML version at
<a href="http://eschulte.github.io/emacs-web-server/">emacs-web-server</a>.
</p>

<div id="outline-container-sec-1" class="outline-2">
<h2 id="sec-1"><span class="section-number-2">1</span> Installation and running a server</h2>
<div class="outline-text-2" id="text-1">
<p>
Most easily installable through the GNU ELPA, run <code>M-x
package-list-packages</code> select <code>web-server</code> and install.  Alternately,
install from the git repository at
<a href="https://github.com/eschulte/emacs-web-server">https://github.com/eschulte/emacs-web-server</a> and update your the load.
</p>

<ol class="org-ol">
<li>Ensure that you have Emacs version 24 or greater installed.

<div class="org-src-container">

<pre class="src src-sh">emacs --version
</pre>
</div>

<pre class="example">
GNU Emacs 24.3.1
Copyright (C) 2013 Free Software Foundation, Inc.
GNU Emacs comes with ABSOLUTELY NO WARRANTY.
You may redistribute copies of Emacs
under the terms of the GNU General Public License.
For more information about these matters, see the file named COPYING.
</pre>
</li>

<li>Download and unpack the zip archive of the Emacs web-server code
from <a href="https://github.com/eschulte/emacs-web-server/archive/master.zip">emacs-web-server-master.zip</a> or clone the source code
repository with <a href="http://git-scm.com/">git</a>.

<div class="org-src-container">

<pre class="src src-sh">git clone https://github.com/eschulte/emacs-web-server.git
</pre>
</div>
</li>

<li>Move into the root of the <code>emacs-web-server/</code> directory and
optionally run <code>make</code> to compile the web-server code, and run <code>make
   check</code> to test your web-server install.

<div class="org-src-container">

<pre class="src src-sh">make
make check
</pre>
</div>
</li>

<li>From the root of the <code>emacs-web-server/</code> directory, start an
instance of Emacs with web-server loaded.

<div class="org-src-container">

<pre class="src src-sh">emacs -Q -L . -l web-server
</pre>
</div>

<p>
Alternately, from an already running Emacs instance, add this
directory to the load path and load the web server with the
following.
</p>

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #7f7f7f;">(</span>add-to-list 'load-path <span style="color: #e9b96e;">"path/to/emacs-web-server"</span><span style="color: #7f7f7f;">)</span>
<span style="color: #7f7f7f;">(</span><span style="color: #b4fa70;">require</span> '<span style="color: #e9b2e3;">web-server</span><span style="color: #7f7f7f;">)</span>
</pre>
</div>
</li>

<li>Evaluate the following code in <code>*scratch*</code> buffer of this Emacs
instance.

<div class="org-src-container">

<pre class="src src-emacs-lisp"><span style="color: #7f7f7f;">(</span>ws-start
 <span style="color: #7f7f7f;">(</span><span style="color: #b4fa70;">lambda</span> <span style="color: #7f7f7f;">(</span>request<span style="color: #7f7f7f;">)</span>
   <span style="color: #7f7f7f;">(</span><span style="color: #b4fa70;">with-slots</span> <span style="color: #7f7f7f;">(</span>process headers<span style="color: #7f7f7f;">)</span> request
     <span style="color: #7f7f7f;">(</span>ws-response-header process 200 '<span style="color: #7f7f7f;">(</span><span style="color: #e9b96e;">"Content-type"</span> . <span style="color: #e9b96e;">"text/plain"</span><span style="color: #7f7f7f;">))</span>
     <span style="color: #7f7f7f;">(</span>process-send-string process <span style="color: #e9b96e;">"hello world"</span><span style="color: #7f7f7f;">)))</span>
 9000<span style="color: #7f7f7f;">)</span>
</pre>
</div>
</li>

<li>Browse to <a href="http://localhost:9000/">http://localhost:9000/</a> to see that the web-server is
running.
</li>

<li>Read the web-server <a href="http://eschulte.github.io/emacs-web-server/index.html#Top">manual</a> and work through other <a href="http://eschulte.github.io/emacs-web-server/Usage-Examples.html#Usage-Examples">Usage Examples</a>.
</li>
</ol>
</div>
</div>
<div id="outline-container-sec-2" class="outline-2">
<h2 id="sec-2"><span class="section-number-2">2</span> Running behind a proxy</h2>
<div class="outline-text-2" id="text-2">
<p>
Public-facing instance of the Emacs web-server should be run behind a
more established web server such as <a href="http://httpd.apache.org/">Apache</a> or <a href="http://wiki.nginx.org/">Nginx</a> to provide
additional robustness and security.
</p>

<p>
The following example Apache configuration may be used to have a
public facing Apache server listening on port 80 proxy requests to a
local web-server instance running on port 8888 of the same machine.
</p>

<div class="org-src-container">

<pre class="src src-conf">&lt;VirtualHost *:80&gt;
  ServerName  yourserver.com

  ProxyPass / http://localhost:8888/
&lt;/VirtualHost&gt;
</pre>
</div>

<p>
A similar Nginx configuration is available at
<a href="http://wiki.nginx.org/LoadBalanceExample">http://wiki.nginx.org/LoadBalanceExample</a>.
</p>
</div>
</div>
<div id="outline-container-sec-3" class="outline-2">
<h2 id="sec-3"><span class="section-number-2">3</span> Running behind an https proxy</h2>
<div class="outline-text-2" id="text-3">
<p>
The following example configurations will cause Apache or Nginx to act
as an HTTPS proxy for an instance of the Emacs web server running on
the same machine.  With this setup Apache speaks HTTPS to the outside
world, and communicates with the Emacs web server using HTTP.  This
allows use of HTTPS even though the Emacs web server does not
implement HTTPS itself.  This setup is recommended for any setup, but
should be considered <b>required</b> for sites using BASIC HTTP
Authentication.
</p>
</div>

<div id="outline-container-sec-3-1" class="outline-3">
<h3 id="sec-3-1"><span class="section-number-3">3.1</span> Apache</h3>
<div class="outline-text-3" id="text-3-1">
<p>
This requires that Apache has <code>mod_proxy</code> and <code>mod_ssl</code> enabled, and
that the certificate and key files required for SSL are present.  This
these requirements satisfied, and assuming the Emacs web server is
listening on port 8888 and is running on the same machine as the
Apache web server an Apache virtual host configuration such as the
following.
</p>

<div class="org-src-container">

<pre class="src src-conf">&lt;VirtualHost *:443&gt;
    ProxyPreserveHost On
    ServerName yourserver.com

    SSLEngine On
    SSLCertificateFile /etc/ssl/certs/ssl-cert-snakeoil.pem
    SSLCertificateKeyFile /etc/ssl/private/ssl-cert-snakeoil.key

    ProxyPass / http://localhost:8888/
    ProxyPassReverse / http://localhost:8888/
&lt;/VirtualHost&gt;
</pre>
</div>
</div>
</div>
<div id="outline-container-sec-3-2" class="outline-3">
<h3 id="sec-3-2"><span class="section-number-3">3.2</span> Nginx</h3>
<div class="outline-text-3" id="text-3-2">
<p>
See the following for instructions configuring Nginx as an HTTPS
proxy.
</p>
<ul class="org-ul">
<li><a href="http://wiki.nginx.org/SSL-Offloader#sslproxy.conf">http://wiki.nginx.org/SSL-Offloader#sslproxy.conf</a>
</li>
<li><a href="http://www.cyberciti.biz/faq/howto-linux-unix-setup-nginx-ssl-proxy/">http://www.cyberciti.biz/faq/howto-linux-unix-setup-nginx-ssl-proxy/</a>
</li>
</ul>
</div>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="date">Created: 2014-03-10 Mon 10:46</p>
<p class="creator"><a href="http://www.gnu.org/software/emacs/">Emacs</a> 24.3.50.2 (<a href="http://orgmode.org">Org</a> mode 8.2.5h)</p>
<p class="validation"><a href="http://validator.w3.org/check?uri=referer">Validate</a></p>
</div>
</body>
</html>
